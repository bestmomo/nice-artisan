# make:scope

**Category**: Code Generation & Eloquent

**Related**: make:model, query builder, Local Scopes

---

## Description

The `make:scope` command creates a new **Local Query Scope Class** in your `app/Models/Scopes` directory. Scopes allow you to define common sets of query constraints that can be easily reused throughout your application.

By encapsulating complex or repeated query logic into a dedicated class, you keep your models and controllers clean, promoting the **Don't Repeat Yourself (DRY)** principle.

---

## When to Use This Command

- When you have a complex `where` clause or a set of query constraints that are used frequently across different parts of your application (e.g., getting only active users, or posts published in the last week).
- To define constraints that can be chained together with other query methods.
- To improve code readability by replacing long, repetitive query chains with expressive, named methods.

---

## Basic Usage

The command requires the name you wish to give your Scope Class, often suffixed with `Scope`.

`php artisan make:scope ActiveScope`

---

## Available Options

| Option | Shortcut | Description |
| :--- | :--- | :--- |
| **--force** | | Create the class even if the scope already exists. |

---

## Practical Examples

Create a scope to retrieve published items:
`php artisan make:scope PublishedScope`

Create a scope to filter records by status:
`php artisan make:scope FeaturedScope`

---

## Generated Scope File

The command generates a file, for example `app/Models/Scopes/ActiveScope.php`, with the following base structure. Scopes implement the `apply` method to modify the query builder:

```php
<?php

namespace App\Models\Scopes;

use Illuminate\Database\Eloquent\Builder;
use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\Scope;

class ActiveScope implements Scope
{
    /**
     * Apply the scope to a given Eloquent query builder.
     */
    public function apply(Builder $builder, Model $model): void
    {
        // Add the constraint to the query here
        $builder->where('is_active', true);
    }
}
```
### Usage

#### To apply a scoped constraint

**Define the Scope Method on the Model**: You must define a corresponding method on the Eloquent model (e.g., scopeActive($query)). However, if you use a Scope Class as generated by make:scope, you register it in the model's booted method:
```php
// In App\Models\User.php

use App\Models\Scopes\ActiveScope;

protected static function booted(): void
{
    // This is a Global Scope; you typically want Local Scopes for make:scope
    // For Local Scopes created with make:scope, you integrate them directly:
    // By convention, you create a dedicated scope method in the model:
    // public function scopeActive(Builder $query): void {
    //     $query->where('is_active', true);
    // }

    // --- However, if you prefer the dedicated Scope Class approach: ---
    // Register the scope if it is a GLOBAL scope (applies everywhere):
    // static::addGlobalScope(new ActiveScope); 

    // The make:scope command is usually overkill for simple local scopes, 
    // which are generally defined directly in the model as scope{Name}().
}
```
**Using a Local Scope (via Model Method)**: If the logic were in a traditional model scope (which is more common):
```php
// In a Controller
$activeUsers = User::active()->get();
```
## Related Commands

* **make:model** - The model that the scope is designed to constrain.
* **make:migration** - Used to manage the database schema (ensuring the columns needed by the scope, e.g., `is_active`, `exist`).
* **make:class** - Used for general helper classes, while scopes are specific to query building.

